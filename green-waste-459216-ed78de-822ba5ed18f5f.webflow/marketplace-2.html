<!DOCTYPE html><!--  This site was created in Webflow. https://www.webflow.com  -->
<!--  Last Published: Thu Feb 16 2023 20:15:41 GMT+0000 (Coordinated Universal Time)  -->
<html data-wf-page="63e534fd4f333d0de5139ac6" data-wf-site="63e534fd4f333d4f7f139aa2">
<head>
  <meta charset="utf-8">
  <title>Marketplace</title>
  <meta content="Marketplace" property="og:title">
  <meta content="Marketplace" property="twitter:title">
  <meta content="width=device-width, initial-scale=1" name="viewport">
  <meta content="Webflow" name="generator">
  <link href="css/normalize.css" rel="stylesheet" type="text/css">
  <link href="css/webflow.css" rel="stylesheet" type="text/css">
  <link href="css/green-waste-459216-ed78de-822ba5ed18f5f.webflow.css" rel="stylesheet" type="text/css">
  <link href="https://fonts.googleapis.com" rel="preconnect">
  <link href="https://fonts.gstatic.com" rel="preconnect" crossorigin="anonymous">
  <script src="https://ajax.googleapis.com/ajax/libs/webfont/1.6.26/webfont.js" type="text/javascript"></script>
  <script type="text/javascript">WebFont.load({  google: {    families: ["Montserrat:100,100italic,200,200italic,300,300italic,400,400italic,500,500italic,600,600italic,700,700italic,800,800italic,900,900italic","Merriweather:300,300italic,400,400italic,700,700italic,900,900italic"]  }});</script>
  <!-- [if lt IE 9]><script src="https://cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.3/html5shiv.min.js" type="text/javascript"></script><![endif] -->
  <script type="text/javascript">!function(o,c){var n=c.documentElement,t=" w-mod-";n.className+=t+"js",("ontouchstart"in o||o.DocumentTouch&&c instanceof DocumentTouch)&&(n.className+=t+"touch")}(window,document);</script>
  <link href="images/favicon.ico" rel="shortcut icon" type="image/x-icon">
  <link href="images/webclip.png" rel="apple-touch-icon">
</head>
<body class="body-10">
  <div data-collapse="medium" data-animation="over-left" data-duration="400" data-easing="linear" data-easing2="ease-in" role="banner" class="navigation w-nav">
    <div class="navigation-wrap">
      <a href="index.html" class="logo-link w-nav-brand">Green Waste </a>
      <div class="menu">
        <nav role="navigation" class="navigation-items w-nav-menu">
          <a id="About" href="#" class="navigation-item w-nav-link">About us</a>
          <a href="index.html" class="navigation-item w-nav-link">Services</a>
        </nav>
      </div>
    </div>
  </div>
  <div class="modal1">
    <div data-w-id="46a3dbf1-8025-e7a3-7fc1-c37c66e8b0a9" class="modal-bag"></div>
  </div>
  <div class="section cc-store-home-wrap">
    <div class="container">
      <div>
        <div class="motto-wrap-2">
          <div class="heading-jumbo-small-2">Service providers <br></div>
          <p class="paragraph-light-2">We collect licensed service providers for you <a href="https://www.xano.com/blog/how-to-display-data-from-an-external-api-endpoint-in-webflow/?utm_medium=referral&amp;utm_source=webflow&amp;utm_campaign=webflow-api-blog" target="_blank" class="link-7"><span class="highlight"></span></a><br></p>
        </div>
      </div>
      <div>
        <div class="form-block-9 w-form">
          <form id="email-form-2" name="email-form-2" data-name="Email Form 2" method="get" class="form-10"><input type="text" class="text-field-25 w-input" maxlength="256" name="field" data-name="Field" placeholder="Search the marketplace" id="search">
            <a href="#" id="searching" class="button-40">Search</a>
          </form>
        </div>
      </div>
      <div class="w-form">
        <form id="email-form-3" name="email-form-3" data-name="Email Form 3" method="post" class="ads"><select id="Type" name="field" data-name="Field" required="" class="select-field-3 w-select">
            <option value="">Select one...</option>
            <option value="ACID SLUDGE">ACID SLUDGE</option>
            <option value="Alky effluent">Alky effluent</option>
            <option value="BENZENE OILY SLUDG">BENZENE OILY SLUDG</option>
            <option value="CHEMICAL SLUDGE">CHEMICAL SLUDGE</option>
            <option value="CONTAMIATED BOTTLES">CONTAMIATED BOTTLES</option>
            <option value="CHEMICAL WASTE (PH 5 &amp; BELOW)">CHEMICAL WASTE (PH 5 &amp; BELOW)</option>
            <option value="CONTAMINATED WASTE WATER">CONTAMINATED WASTE WATER</option>
            <option value="CHEMICAL WASTE (PH 5 &amp; ABOVE)">CHEMICAL WASTE (PH 5 &amp; ABOVE)</option>
            <option value="EMPTY GLASS BOTTLES">EMPTY GLASS BOTTLES</option>
            <option value="FLY ASH">FLY ASH</option>
            <option value="GENERAL WASTE">GENERAL WASTE</option>
            <option value="GRP/FRP THERMAL INSULATION MATERIAL WASTE">GRP/FRP THERMAL INSULATION MATERIAL WASTE</option>
            <option value="HYDROCARBON">HYDROCARBON</option>
            <option value="HAZARDOUS WASTE">HAZARDOUS WASTE</option>
            <option value="HAZARDOUS INDUSTRIAL WASTE">HAZARDOUS INDUSTRIAL WASTE</option>
            <option value="INSULATION MATERIALS">INSULATION MATERIALS</option>
            <option value="JUMBO CHEMICAL BAGS">JUMBO CHEMICAL BAGS</option>
            <option value="LAB WASTE ">LAB WASTE </option>
            <option value="LIME SLUDGE">LIME SLUDGE</option>
            <option value="MGCL2 SOLID WASTE">MGCL2 SOLID WASTE</option>
            <option value="OILY WATER">OILY WATER</option>
            <option value="OILY SLUDGE">OILY SLUDGE</option>
            <option value="SODIUM SULFATE">SODIUM SULFATE</option>
            <option value="SOLID SULFUR">SOLID SULFUR</option>
            <option value="SPENT CLAY">SPENT CLAY</option>
            <option value="SPENT CAUSTIC">SPENT CAUSTIC</option>
            <option value="SPENT SULFURIC ACID">SPENT SULFURIC ACID</option>
            <option value="Spent Earth">Spent Earth</option>
            <option value="TALC POWDER MIXED ">TALC POWDER MIXED </option>
            <option value="THINNER">THINNER</option>
            <option value="USED OIL FILTER">USED OIL FILTER</option>
            <option value="USED FILTERS">USED FILTERS</option>
            <option value="USED OIL">USED OIL</option>
          </select><input type="text" class="text-field-38 w-input" maxlength="256" name="field" data-name="Field" placeholder="Example Text" id="from_places" required=""><select id="budget" name="field-3" data-name="Field 3" required="" class="location-2 w-select">
            <option value="">Select Budget</option>
            <option value="Premium">Premium</option>
            <option value="Business">Business</option>
            <option value="Economic">Economic</option>
          </select>
          <a id="advance" href="#" class="button-51 w-button">Advance search</a>
        </form>
      </div>
    </div>
  </div>
  <div class="section api-content">
    <div class="container">
      <div class="section-heading-wrap-2"></div>
      <div id="Cards-Container" class="w-layout-grid api-data-goes-here">
        <div id="samplestyle" class="sample-card-2 w-node-_4dd8f55b-00b9-5804-add4-730ce6ac2597-e5139ac6">
          <div class="div-block-16">
            <h6 id="H6" class="heading-8">Heading</h6>
          </div>
          <h3 class="heading-3">Heading</h3>
          <p class="paragraph-3">Lorem ipsum dolor sit amet, consectetur adipiscing elit. Su</p>
          <a href="#" class="button-35 w-button">Learn more</a><img src="images/Sage-Green-Aesthetic-Wallpaper-6.png" loading="lazy" width="162" sizes="100vw" srcset="images/Sage-Green-Aesthetic-Wallpaper-6-p-500.png 500w, images/Sage-Green-Aesthetic-Wallpaper-6-p-800.png 800w, images/Sage-Green-Aesthetic-Wallpaper-6-p-1080.png 1080w, images/Sage-Green-Aesthetic-Wallpaper-6-p-1600.png 1600w, images/Sage-Green-Aesthetic-Wallpaper-6.png 1920w" alt="" class="image-25">
        </div>
      </div>
    </div>
  </div>
  <script src="https://d3e54v103j8qbb.cloudfront.net/js/jquery-3.5.1.min.dc5e7f18c8.js?site=63e534fd4f333d4f7f139aa2" type="text/javascript" integrity="sha256-9/aliU8dGd2tb6OSsuzixeV4y/faTqgFtohetphbbj0=" crossorigin="anonymous"></script>
  <script src="js/webflow.js" type="text/javascript"></script>
  <!-- [if lte IE 9]><script src="https://cdnjs.cloudflare.com/ajax/libs/placeholders/3.0.2/placeholders.min.js"></script><![endif] -->
  <script src="https://code.jquery.com/jquery-3.6.3.js"></script>
  <script src="https://www.gstatic.com/firebasejs/8.6.8/firebase-app.js"></script>
  <script src="https://www.gstatic.com/firebasejs/8.6.8/firebase-firestore.js"></script>
  <script src="https://www.gstatic.com/firebasejs/8.6.8/firebase-auth.js"></script>
  <script src="https://www.gstatic.com/firebasejs/8.6.8/firebase-database.js"></script>
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
  <script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/9.1.1/firebase-app.js";
import { getFirestore } from "https://www.gstatic.com/firebasejs/9.1.1/firebase-firestore.js"
import { collection, getDocs, addDoc, Timestamp } from "https://www.gstatic.com/firebasejs/9.1.1/firebase-firestore.js"
import { query, orderBy, limit, where, onSnapshot } from "https://www.gstatic.com/firebasejs/9.1.1/firebase-firestore.js"
  const firebaseConfig = {
    apiKey: "AIzaSyDGrZtDS9lBiOA-KZIB61CC43KL2yEKlkk",
    authDomain: "green-waste-1d4dc.firebaseapp.com",
    projectId: "green-waste-1d4dc",
    storageBucket: "green-waste-1d4dc.appspot.com",
    messagingSenderId: "465078550816",
    appId: "1:465078550816:web:54428ca9c48db03b99d745",
    measurementId: "G-YWHBNXLJVC"
  };
         firebase.initializeApp(firebaseConfig);
       var originDestination;
  function initMap() {
    autocomplete = new google.maps.places.Autocomplete((document.getElementById('from_places')), {
      types: ['geocode']
    });
  } // end of initMap
  $(function() {
    window.addEventListener('click', function(event) {
      var from_places = new google.maps.places.Autocomplete(
        document.getElementById("from_places"));
      google.maps.event.addListener(
        from_places,
        "place_changed",
        function() {
          var from_place = from_places.getPlace();
          var from_address = from_place.formatted_address;
          originDestination = from_address;
        });
    });
    var dest = ["Riyadh Saudi Arabia",
      "Mecca Saudi Arabia",
      "Medina Saudi Arabia",
      "Al Bahah Saudi Arabia",
      "Al Qassim Province Saudi Arabia",
      "Hail Saudi Arabia",
      "Tabuk Saudi Arabia",
      "Abha Saudi Arabia",
      "Najran Saudi Arabia",
      "Jazan Saudi Arabia",
      "Al Jawf Saudi Arabia"
    ];
    function calculateDistance() {
      var service = new google.maps.DistanceMatrixService();
      var origin = originDestination;
      var dest = ["Riyadh Saudi Arabia",
        "Mecca Saudi Arabia",
        "Medina Saudi Arabia",
        "Al Bahah Saudi Arabia",
        "Al Qassim Province Saudi Arabia",
        "Hail Saudi Arabia",
        "Tabuk Saudi Arabia",
        "Abha Saudi Arabia",
        "Najran Saudi Arabia",
        "Jazan Saudi Arabia",
        "Al Jawf Saudi Arabia"
      ];
      var service = new google.maps.DistanceMatrixService();
      service.getDistanceMatrix({
          origins: [origin],
          destinations: ["Riyadh Saudi Arabia",
            "Mecca Saudi Arabia",
            "Medina Saudi Arabia",
            "Al Bahah Saudi Arabia",
            "Al Qassim Province Saudi Arabia",
            "Hail Saudi Arabia",
            "Tabuk Saudi Arabia",
            "Abha Saudi Arabia",
            "Najran Saudi Arabia",
            "Jazan Saudi Arabia",
            "Al Jawf Saudi Arabia"
          ],
          travelMode: google.maps.TravelMode.DRIVING,
          unitSystem: google.maps.UnitSystem.METRIC,
          avoidTolls: false,
        },
        callback);
    }
    function callback(response, status) {
      if (status == 'OK') {
        var origins = response.originAddresses;
        var destinations = dest;
        var resultsArray = [];
        for (var i = 0; i < origins.length; i++) {
          var results = response.rows[i].elements;
          for (var j = 0; j < results.length; j++) {
            var element = results[j];
            var distance = element.distance.text;
            var from = origins[i];
            var to = destinations[j];
            resultsArray.push({
              distance,
              from,
              to
            });
          }
        }
        resultsArray.sort(function(a, b) {
          return parseInt(a.distance.replace(/[^\d.]/g, '')) - parseInt(b.distance.replace(/[^\d.]/g, ''));
        });
        console.log(resultsArray);
      }
      const toValues = resultsArray.map((item) => item.to);
      console.log(toValues);
      recommend(toValues);
    } //callback
    function recommend(toValues) {
      const db = firebase.firestore();
      var type = document.getElementById("Type").value;
      var lctn = originDestination;
      let selectElement = document.getElementById('budget');
      let chosenOption = selectElement.value;
      let lowPrice;
      let highPrice;
      $('#Cards-Container').children().hide();
      if (chosenOption == 'Premium') {
        highPrice = 5000000000000;
        lowPrice = 1000;
      } else if (chosenOption == 'Business') {
        highPrice = 999;
        lowPrice = 500;
      } else if (chosenOption == 'Economic') {
        highPrice = 499;
        lowPrice = 50;
      }
      db.collection("serviceProviders")
        .where("SP_Speciality", "==", type)
        .where("SP_Location", "==", lctn)
        .where('Price', '<=', highPrice)
        .where('Price', '>=', lowPrice)
        .orderBy('Price', 'desc')
        .orderBy('Rate', 'desc')
        .get()
        .then((querySnapshot) => {
          if (!querySnapshot.empty) {
            querySnapshot.forEach((doc) => {
              console.log(doc.id, " => ", doc.data());
              showData(doc.data(),doc.id);
            });
          } //end of if
          else if (querySnapshot.empty) {
            console.log("we could not find documents with these specifications");
            console.log("here are some other alternatives...");
            for (let i = 0; i < toValues.length; i++) {
              lctn = toValues[i];
              db.collection("serviceProviders")
                .where("SP_Speciality", "==", type)
                .where("SP_Location", "==", lctn)
                .where('Price', '<=', highPrice)
                .where('Price', '>=', lowPrice)
                .orderBy('Price', 'desc')
                .orderBy('Rate', 'desc')
                .get()
                .then((querySnapshot) => {
                  if (!querySnapshot.empty) {
                    querySnapshot.forEach((doc) => {
                      console.log(doc.id, " => ", doc.data());
                      showData(doc.data(),doc.id);
                      document.getElementById("NoResult").style.display ="none";
                    });
                  } else if (querySnapshot.empty) {
                    console.log("no resluts");
                    //no results
                    return;
                  } else {
                  }
                }).catch((error) => {
                  console.log("Error getting documents: ", error);
                });
            } //for
          } 
        })
        .catch((error) => {
          console.log("Error getting documents: ", error);
       });
    }
    document.getElementById("advance").addEventListener("click", calculateDistance);
  })//function
   const app = initializeApp(firebaseConfig);
   const db = getFirestore(app);
   var myUrl = new URL(document.location.href);
       var myParam = myUrl.searchParams.get("search") || null;
       const querySnapshot = await getDocs(collection(db, "serviceProviders"));
       const cardContainer = document.getElementById("Cards-Container");
    if (myParam == null) {
        querySnapshot.forEach((doc) => {
            showData(doc.data(),doc.id);
        });
    } else if (myParam != null){
        querySnapshot.forEach((doc) => {
            if (doc.data().SP_name.toLowerCase().includes(myParam.toLowerCase())) {
                showData(doc.data(),doc.id);
            }
        });
    } 
       var searching = document.getElementById("searching");
       searching.addEventListener('click', async () => {
           var srch = document.getElementById("search").value;
           window.location = "?search=" + srch;
       });
function showData(data, id) {
  var sp_name = data.SP_name;
               var sp_location = data.SP_Location;
               var rate = data.Rate;
               var sp_speciality = data.SP_Speciality;
               const style = document.getElementById('samplestyle')
               // Copy the card and it's style
               const card = style.cloneNode(true);
               card.setAttribute('id', '');
               card.style.display = 'block';
               card.addEventListener('click', function () {
                   window.location = "/profile?id=" + id;});
               const h3 = card.getElementsByTagName('H3')[0]
               h3.textContent = sp_name;
               const h6 = card.getElementsByTagName('H6')[0]
               h6.textContent = rate;
               const p = card.getElementsByTagName('P')[0]
               p.textContent = "Location: " + sp_location;
               let p1 = document.createElement('p');
               p1.innerHTML = "Speciality: " + sp_speciality;
               card.appendChild(p1);
               cardContainer.appendChild(card);}
</script>
  <script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyAy2QxG63ah24seS1M4dzVLlj6F-sHxiQ4&libraries=places&callback=initMap" async="" defer="">
</script>
</body>
</html>